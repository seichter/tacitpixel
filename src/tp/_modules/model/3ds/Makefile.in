
TAP=@top_srcdir@

include $(TAP)/config


# name
NAME = tp3DS

# whats out
OUTPUT = $(NAME).@SO_SUFFIX@

BUILDDIR = $(TAP)/bin
SRCDIR = $(TAP)/src

# include directory
INCLUDES = -I$(TAP)/include -Ilib3ds -I./lib -I.

LIBPATH= @LDFLAGS@


# some flags for the compiler
CXXFLAGS = -Wall $(INCLUDES) @CPPFLAGS@ 

VERSION=@LIB_MAJOR@

# doxygen
DOXYGEN = doxygen

# compilers
CXX = @CXX@
CC = @CC@

# archive
AR = ar
RANLIB = ranlib

AROPTIONS = rcu

LIBS = -L$(TAP)/lib -lTAP @LIBS@

objects = main.o \
	lib3ds/atmosphere.o \
	lib3ds/background.o \
	lib3ds/camera.o \
	lib3ds/chunk.o \
	lib3ds/ease.o \
	lib3ds/file.o \
	lib3ds/float.o \
	lib3ds/io.o \
	lib3ds/light.o \
	lib3ds/material.o \
	lib3ds/matrix.o \
	lib3ds/mesh.o \
	lib3ds/node.o \
	lib3ds/quat.o \
	lib3ds/shadow.o \
	lib3ds/tcb.o \
	lib3ds/tracks.o \
	lib3ds/vector.o \
	lib3ds/viewport.o


TARGETS=$(OUTPUT)

.PHONY: all clean new doc


all : $(TARGETS)


%.o : %.cpp
	$(CXX) @CPPFLAGS_PLUGIN@ -c $(CXXFLAGS) $(INCLUDES) -o $@ $<

%.o : %.c
	$(CC) @CPPFLAGS_PLUGIN@ -c $(CXXFLAGS) $(INCLUDES) -o $@ $<


$(OUTPUT):$(objects)
	$(CC) @LDFLAGS_PLUGIN@ -o $@ $(objects) $(LIBS) $(LIBPATH)
	cp -f $@ $(BUILDDIR)/$@


clean :
	@echo Removing files ...
	rm -f $(objects) $(OUTPUT)


new: clean all
